create table t1(a int);
insert into t1 values (0),(1),(2),(3),(4),(5),(6),(7),(8),(9);

create table t2 (b int,
                 col1 varchar(255),
                 col2 varchar(255)
                 ) character set utf8;

insert into t2 select
  A.a+10*B.a,
  concat('wow-wow-col1-value-', A.a+10*B.a+100*C.a),
  concat('wow-wow-col2-value-', A.a+10*B.a+100*C.a)
from
  t1 A, t1 B, t1 C where C.a < 8;

select distinct A.col1 as XX, B.col1 as YY
from
   t2 A, t2 B
where A.b = B.b
order by A.col2, B.col2;

--echo # should use one sort merge
show status like '%sort%';

drop table t1,t2;

